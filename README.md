# Система задач для Screeps

Это система управления задачами для игры Screeps, реализующая приоритетное распределение задач между крипами разных ролей.

## Архитектура системы

### Основные модули

1. **taskManager.js** - Ядро системы задач
   - Управление глобальным списком задач
   - Приоритеты: HIGH, MEDIUM, LOW
   - Роли: Miner, Taxi, Courier, Builder, Repairer, Upgrader, Spawner
   - Хранение в Game.memory

2. **roomScanner.js** - Сканирование комнат
   - Автоматическое создание задач на основе состояния комнаты
   - Проверка актуальности задач (раз в 15 тиков)
   - Создание задач для источников, строительства, ремонта и т.д.

3. **creepManager.js** - Управление крипами
   - Назначение задач крипам на основе ролей
   - Привязка майнеров к источникам
   - Логика выполнения задач для каждой роли

4. **spawnerManager.js** - Управление спавнерами
   - Спавн крипов на основе потребностей
   - Оптимизация тел крипов под роли
   - Балансировка между ролями

5. **main.js** - Основной цикл
   - Координация всех модулей
   - 15-тиковые циклы проверки
   - Логирование состояния системы

## Особенности системы

### Ролевая система
- **Miner** - Майнеры без ног, копают под себя, привязаны к источнику
- **Taxi** - Доставка майнеров на место работы
- **Courier** - Транспортировка ресурсов из куч
- **Builder** - Строительство конструкций
- **Repairer** - Ремонт структур
- **Upgrader** - Апгрейд контроллера
- **Spawner** - Спавн крипов

### Особенности игры
- 1 источник = 1 майнер (фиксированное соответствие)
- Майнеры привязаны к источнику и не могут менять место
- Все остальные крипы берут ресурсы из куч (не из контейнеров)
- Майнеры не имеют ног, требуют доставки Taxi

### Приоритеты задач
- **HIGH** - Критические задачи (доставка майнеров, защита)
- **MEDIUM** - Важные задачи (строительство, апгрейд, ремонт)
- **LOW** - Рутинные задачи (обычный ремонт, сбор)

### Циклы работы
- **15 тиков** - Сканирование комнат и проверка задач
- **Каждый тик** - Назначение задач и управление крипами
- **100 тиков** - Логирование состояния системы

## Примеры задач

### Бесконечные задачи
```javascript
{
  type: "MINE_SOURCE",
  target: "source_id",
  roles: ["Miner"],
  infinite: true,
  priority: "HIGH"
}
```

### Персональные задачи
```javascript
{
  type: "DELIVER_MINER",
  target: "source_id",
  roles: ["Taxi"],
  priority: "HIGH"
}
```

### Обычные задачи
```javascript
{
  type: "BUILD",
  target: "construction_site_id",
  roles: ["Builder", "Repairer"],
  priority: "MEDIUM"
}
```

## Использование

### Запуск системы
Система автоматически запускается через main.js. Достаточно загрузить файлы в игру.

### Добавление новых ролей
1. Добавить роль в taskManager.ROLE
2. Реализовать логику в creepManager для новой роли
3. Обновить spawnerManager для спавна новой роли

### Добавление новых типов задач
1. Добавить тип в taskManager.TASK_TYPE
2. Реализовать логику создания в roomScanner
3. Реализовать логику выполнения в creepManager

## Логика работы

### 1. Создание задач
- Каждые 15 тиков сканируются все комнаты
- Автоматически создаются задачи на основе состояния комнаты
- Задачи распределяются по приоритетам и ролям

### 2. Назначение крипов
- Крипы ищут свободные задачи подходящей роли
- Выбирается задача с наивысшим приоритетом
- Крип привязывается к задаче и начинает выполнение

### 3. Спавн крипов
- Спавнеры анализируют потребность в крипах
- Создаются крипы с оптимальным телом для роли
- Приоритет: Miner → Taxi → Courier → Builder → Repairer → Upgrader

### 4. Выполнение задач
- Каждая роль имеет свою логику выполнения
- Майнеры привязываются к источникам
- Такси доставляют майнеров на место
- Остальные крипы работают с кучами ресурсов

## Требования

- Игра Screeps
- Доступ к Game API
- Минимум одна комната с контроллером
- Спавнер для создания крипов

## Лицензия

Этот код предоставляется как есть для использования в игре Screeps.